z(1)=14.134725142;
z(2)=21.022039639;
z(3)=25.010857580;
z(4)=30.424876126;
z(5)=32.935061588;
z(6)=37.586178159;
z(7)=40.918719012;
z(8)=43.327073281;
z(9)=48.005150881;
z(10)=49.773832478;
z(11)=52.970321478;
z(12)=56.446247697;
z(13)=59.347044003;
z(14)=60.831778525;
z(15)=65.112544048;
z(16)=67.079810529;
z(17)=69.546401711;
z(18)=72.067157674;
z(19)=75.704690699;
z(20)=77.144840069;
z(21)=79.337375020;
z(22)=82.910380854;
z(23)=84.735492981;
z(24)=87.425274613;
z(25)=88.809111208;
z(26)=92.491899271;
z(27)=94.651344041;
z(28)=95.870634228;
z(29)=98.831194218;
z(30)=101.317851006;
z(31)=103.725538040;
z(32)=105.446623052;
z(33)=107.168611184;
z(34)=111.029535543;
z(35)=111.874659177;
z(36)=114.320220915;
z(37)=116.226680321;
z(38)=118.790782866;
z(39)=121.370125002;
z(40)=122.946829294;
z(41)=124.256818554;
z(42)=127.516683880;
z(43)=129.578704200;
z(44)=131.087688531;
z(45)=133.497737203;
z(46)=134.756509753;
z(47)=138.116042055;
z(48)=139.736208952;
z(49)=141.123707404;
z(50)=143.111845808;
z(51)=146.000982487;
z(52)=147.422765343;
z(53)=150.053520421;
z(54)=150.925257612;
z(55)=153.024693811;
z(56)=156.112909294;
nz=56;
xmin=2;
xmax=20;
nmax=xmax;
dx=0.1;
x=xmin:dx:xmax;
nx=round(1+(xmax-xmin)/dx);
for ix=1:nx
    sum(ix)=1/log(x(ix));
    for iz=1:nz
        term=cos(z(iz)*log(x(ix)))/(sqrt(x(ix))*log(x(ix)));
        sum=sum-2*term;
    end
    f(ix)=sum(ix);
end
y(1)=0;
y(2)=0.5*(f(1)+f(2))*dx;
for ix=2:nx
    y(ix)=simp(dx,ix,x,f);
end
ss=primes(xmax);
ns=length(ss)
pi1(2)=0;
w(1)=0;
for in=2:nmax-1
    w(in)=in;
    for is=1:ns
        if ss(is) == in
            pi1(in)=pi1(in)+1;
        end
    end
    pi1(in+1)=pi1(in);
end    
for in=1:nmax-1
    pi2(in)=pi1(in);
end

plot(x,y,w,pi2)
